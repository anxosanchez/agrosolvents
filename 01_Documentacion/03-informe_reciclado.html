<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en">

<head>

<meta charset="utf-8" />
<meta name="generator" content="quarto-1.9.11" />

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes" />


<title>informe_reciclado – Proxecto AGROSOLVENTS</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>

<!-- htmldependencies:E3FAD763 -->
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>

  <script src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6"></script>
  <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml-full.js" type="text/javascript"></script>

<script type="text/javascript">
const typesetMath = (el) => {
  if (window.MathJax) {
    // MathJax Typeset
    window.MathJax.typeset([el]);
  } else if (window.katex) {
    // KaTeX Render
    var mathElements = el.getElementsByClassName("math");
    var macros = [];
    for (var i = 0; i < mathElements.length; i++) {
      var texText = mathElements[i].firstChild;
      if (mathElements[i].tagName == "SPAN" && texText && texText.data) {
        window.katex.render(texText.data, mathElements[i], {
          displayMode: mathElements[i].classList.contains('display'),
          throwOnError: false,
          macros: macros,
          fleqn: false
        });
      }
    }
  }
}
window.Quarto = {
  typesetMath
};
</script>

</head>

<body>

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="/index.html">
    <span class="navbar-title">Proxecto AGROSOLVENTS</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse"
  aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation"
  onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="/memoria_final.html"> 
<span class="menu-text">Resumo Executivo</span></a>
  </li>  
  <li class="nav-item dropdown ">
    <a class="nav-link dropdown-toggle" href="#" id="nav-menu-seccións" role="link" data-bs-toggle="dropdown" aria-expanded="false" >
 <span class="menu-text">Seccións</span>
    </a>
    <ul class="dropdown-menu" aria-labelledby="nav-menu-seccións">    
        <li>
    <a class="dropdown-item" href="/Informe_Final_Investigacion_Agrosolvents.md">
 <span class="dropdown-text">Introdución</span></a>
  </li>  
    </ul>
  </li>
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-article page-navbar">
<!-- sidebar -->
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar">
        <div id="quarto-toc-target"></div>
    </div>
<!-- main -->
<main class="content" id="quarto-document-content">



<nav id="TOC" role="doc-toc">
    <h2 id="toc-title">On this page</h2>
   
  <ul>
  <li><a href="#simulación-de-uns-planta-de-reciclado-de-fames-y-microemulsiones" id="toc-simulación-de-uns-planta-de-reciclado-de-fames-y-microemulsiones"><span class="header-section-number">1</span> Simulación de uns planta de reciclado de fames y microemulsiones</a>
  <ul>
  <li><a href="#definición-del-problema-y-el-caudal-de-entrada" id="toc-definición-del-problema-y-el-caudal-de-entrada"><span class="header-section-number">1.1</span> Definición del problema y el caudal de entrada</a></li>
  <li><a href="#selección-de-operaciones-unitarias" id="toc-selección-de-operaciones-unitarias"><span class="header-section-number">1.2</span> Selección de operaciones unitarias</a></li>
  <li><a href="#elección-de-software-de-simulación" id="toc-elección-de-software-de-simulación"><span class="header-section-number">1.3</span> Elección de software de simulación</a></li>
  <li><a href="#configuración-de-la-simulación" id="toc-configuración-de-la-simulación"><span class="header-section-number">1.4</span> Configuración de la simulación</a></li>
  <li><a href="#pasos-para-configurar-la-simulación-ejemplo-en-dwsimaspen" id="toc-pasos-para-configurar-la-simulación-ejemplo-en-dwsimaspen"><span class="header-section-number">1.5</span> Pasos para configurar la simulación (Ejemplo en DWSIM/Aspen)</a></li>
  </ul></li>
  <li><a href="#evaporador-de-película-agitada-atfe---agitated-thin-film-evaporator" id="toc-evaporador-de-película-agitada-atfe---agitated-thin-film-evaporator"><span class="header-section-number">2</span> Evaporador de Película Agitada (ATFE - Agitated Thin Film Evaporator)</a>
  <ul>
  <li><a href="#la-física-del-atfe" id="toc-la-física-del-atfe"><span class="header-section-number">2.1</span> La Física del ATFE</a></li>
  <li><a href="#bibliotecas-python-necesarias" id="toc-bibliotecas-python-necesarias"><span class="header-section-number">2.2</span> Bibliotecas Python necesarias</a></li>
  </ul></li>
  <li><a href="#códigos-de-simulaciónen-python" id="toc-códigos-de-simulaciónen-python"><span class="header-section-number">3</span> Códigos de simulaciónen python</a></li>
  <li><a href="#simulaciones-de-recuperación-de-fames-y-microemulsiones-en-aspen---hysys-y-dwsim" id="toc-simulaciones-de-recuperación-de-fames-y-microemulsiones-en-aspen---hysys-y-dwsim"><span class="header-section-number">4</span> Simulaciones de recuperación de FAMES y microemulsiones en ASPEN - HYSYS y DWSIM</a>
  <ul>
  <li><a href="#el-biodiésel-como-biosolvente-industrial" id="toc-el-biodiésel-como-biosolvente-industrial"><span class="header-section-number">4.1</span> El Biodiésel como Biosolvente Industrial</a></li>
  <li><a href="#tecnología-clave-evaporador-de-película-agitada-atfe" id="toc-tecnología-clave-evaporador-de-película-agitada-atfe"><span class="header-section-number">4.2</span> Tecnología Clave: Evaporador de Película Agitada (ATFE)</a></li>
  <li><a href="#comparativa-girasol-vs.-palma" id="toc-comparativa-girasol-vs.-palma"><span class="header-section-number">4.3</span> Comparativa: Girasol vs. Palma</a></li>
  <li><a href="#diagrama-de-bloques-del-proceso-de-reciclado" id="toc-diagrama-de-bloques-del-proceso-de-reciclado"><span class="header-section-number">4.4</span> Diagrama de Bloques del Proceso de Reciclado</a></li>
  <li><a href="#implicaciones-ambientales-lca---análisis-de-ciclo-de-vida" id="toc-implicaciones-ambientales-lca---análisis-de-ciclo-de-vida"><span class="header-section-number">4.5</span> Implicaciones Ambientales (LCA - Análisis de Ciclo de Vida)</a></li>
  <li><a href="#biodiésel-de-girasol" id="toc-biodiésel-de-girasol"><span class="header-section-number">4.6</span> Biodiésel de Girasol</a></li>
  <li><a href="#biodiésel-de-palma" id="toc-biodiésel-de-palma"><span class="header-section-number">4.7</span> Biodiésel de Palma</a></li>
  <li><a href="#resumen-del-proceso-de-reciclado" id="toc-resumen-del-proceso-de-reciclado"><span class="header-section-number">4.8</span> Resumen del Proceso de Reciclado</a></li>
  </ul></li>
  <li><a href="#reciclado-de-ésteres-dibásicos" id="toc-reciclado-de-ésteres-dibásicos"><span class="header-section-number">5</span> Reciclado de ésteres dibásicos</a>
  <ul>
  <li><a href="#qué-son-los-ésteres-dibásicos-dbe" id="toc-qué-son-los-ésteres-dibásicos-dbe"><span class="header-section-number">5.1</span> ¿Qué son los Ésteres Dibásicos (DBE)?</a></li>
  <li><a href="#el-reciclado-de-dbes" id="toc-el-reciclado-de-dbes"><span class="header-section-number">5.2</span> El Reciclado de DBEs</a></li>
  <li><a href="#la-mezcla-dbe-fame-retos-de-interacción" id="toc-la-mezcla-dbe-fame-retos-de-interacción"><span class="header-section-number">5.3</span> La Mezcla DBE + FAME: Retos de Interacción</a></li>
  <li><a href="#implementación-en-la-simulación-python" id="toc-implementación-en-la-simulación-python"><span class="header-section-number">5.4</span> Implementación en la Simulación Python</a></li>
  <li><a href="#la-física-cuánta-energía-cuesta-mover-las-aspas" id="toc-la-física-cuánta-energía-cuesta-mover-las-aspas"><span class="header-section-number">5.5</span> La Física: ¿Cuánta energía cuesta mover las aspas?</a></li>
  <li><a href="#interpretación-de-la-simulación" id="toc-interpretación-de-la-simulación"><span class="header-section-number">5.6</span> Interpretación de la simulación</a></li>
  <li><a href="#simulación-con-aceite-de-palma-en-vez-de-girasol" id="toc-simulación-con-aceite-de-palma-en-vez-de-girasol"><span class="header-section-number">5.7</span> Simulación con aceite de palma en vez de girasol</a></li>
  </ul></li>
  <li><a href="#conclusiones" id="toc-conclusiones"><span class="header-section-number">6</span> Conclusiones</a>
  <ul>
  <li><a href="#conclusiones-del-estudio" id="toc-conclusiones-del-estudio"><span class="header-section-number">6.1</span> Conclusiones del Estudio</a></li>
  <li><a href="#recomendaciones-para-trabajos-futuros" id="toc-recomendaciones-para-trabajos-futuros"><span class="header-section-number">6.2</span> Recomendaciones para Trabajos Futuros</a></li>
  </ul></li>
  </ul>
</nav>
<section id="simulación-de-uns-planta-de-reciclado-de-fames-y-microemulsiones" class="level2" data-number="1">
<h2 data-number="1"><span class="header-section-number">1</span> Simulación de uns planta de reciclado de fames y microemulsiones</h2>
<p>La simulación de una planta de reciclaje de biodiésel (FAME - Fatty Acid Myl Esters) que ha sido utilizado como disolvente industrial es un proyecto de ingeniería química complejo. No obstante, en este proyecto se trata de analizar e intentar aprovechas las capacidades de la emprese hermana d DORVI, REGADI, posee en las instalaciones de DROVI y destinadas al reciclaje de disolventes convencioonales por combinaci´on de evaporación en un evpapofador de capa fina agitada y una columna de destilación.</p>
<p>Los FAME poseen un alto punto de ebullición y propiedades termodinámicas específicas que hacen que su recuperación requiera cuidados para evitar la degradación térmica. Aquí hay una hoja de ruta estructurada paso a paso para comenzar su proyecto:</p>
<section id="definición-del-problema-y-el-caudal-de-entrada" class="level3" data-number="1.1">
<h3 data-number="1.1"><span class="header-section-number">1.1</span> Definición del problema y el caudal de entrada</h3>
<p>Antes de abrir cualquier software, necesita datos concretos. El simulador devolverá basura si introducimos basura (basura que entra, basura que sale). - Composición del biodiesel: Suele ser una mezcla de ésteres metílicos (C16, C18, etc.). Para la simulación, el oleato de metilo se utiliza a menudo como “pseudocomponente” representativo si no se dispone de la cromatografía exacta. - Contaminantes: ¿Qué disolvió el biodiesel? - ¿Pinturas o resinas? (Sólidos o polímeros) - ¿Aceites minerales? (Hidrocarburos Pesados) - Agua? - Especificaciones del Producto: - ¿Qué pureza necesita para reutilizar como solvente? (ej. 99 % de pureza, &lt;0,05 % de agua).</p>
</section>
<section id="selección-de-operaciones-unitarias" class="level3" data-number="1.2">
<h3 data-number="1.2"><span class="header-section-number">1.2</span> Selección de operaciones unitarias</h3>
<p>Dependiendo de los contaminantes, el proceso variará, pero el esquema clásico para recuperar solventes de alto punto de ebullición suele ser: - Filtración: si el biodiesel tiene partículas sólidas o lodos arrastrados. - Decantación (flash): si hay agua o solventes altamente volátiles mezclados, un tanque flash puede separarlos fácilmente. - Destilación al vacío: este es el punto crítico. El biodiesel se degrada (oxida o polimeriza) a altas temperaturas (generalmente por encima de <span class="math inline">\(250^\circ\text{C}\)</span>). - Dado que su punto de ebullición a presión atmosférica es muy alto (<span class="math inline">\(340-375^\circ\text{C}\)</span>), es obligatorio utilizar vacío para bajar la temperatura de ebullición y destilarlo sin “quemarlo”</p>
</section>
<section id="elección-de-software-de-simulación" class="level3" data-number="1.3">
<h3 data-number="1.3"><span class="header-section-number">1.3</span> Elección de software de simulación</h3>
<p>Hay varias opciones según el presupuesto y acceso: - Aspen Plus / Aspen HYSYS: El estándar de la industria. Tiene bases de datos muy completas para FAMEs. - ChemCAD: Muy potente para procesos químicos y destilaciones. - DWSIM (Recomendado por precio): Es Open Source y gratuito. Tiene una buena base de datos y permite simular destilaciones y reactores. Para un proyecto académico o de creación de prototipos, es la mejor opción. - ProSim: Otra opción comercial con buenas capacidades de simulación. - Simuladores específicos de destilación: Algunos simuladores están especializados en destilación y pueden ser útiles si la destilación es el foco principal.</p>
<p>En nuestro caso (UVIGO) poseemos software de simulación ASPEN - HYSYS que es el utilizado en muchos de nuestras simulaciones sobre todo en lo relacionado acon la viabilidad de la recuperación y la simulación del reciclado de los palmitatos y las microsemulsiones pero,desafortunadamente la empresa DROVI no posee licencia de este software y, dado que la licencia de la UVIGO es de educación, no podemos pasar los archivos de simulación a entidades privadas, por lo que se recomienda utilizar DWSIM que es gratuito y de código abierto en sus simulaciones. No obstante, en este apartado dejaremos las instrucciones necesarias para la simulación con ASPEN - HYSYS y DWSIM.</p>
</section>
<section id="configuración-de-la-simulación" class="level3" data-number="1.4">
<h3 data-number="1.4"><span class="header-section-number">1.4</span> Configuración de la simulación</h3>
<section id="modelo-termodinámico-el-motor-de-la-simulación-esta-es-una-decisión-técnica-muy-importante.-el-biodiesel-es-una-molécula-polar-y-orgánica-or-lo-que" class="level4" data-number="1.4.1">
<h4 data-number="1.4.1"><span class="header-section-number">1.4.1</span> Modelo Termodinámico (El “motor” de la simulación) Esta es una decisión técnica muy importante. El biodiesel es una molécula polar y orgánica or lo que:</h4>
<ul>
<li>No se debe usar el modelo de gas ideal.</li>
<li>Utilizar modelos de coeficientes de actividad como NRTL o UNIQUAC. Funcionan muy bien para mezclas líquido-líquido y para predecir el equilibrio cuando hay agua o alcoholes presentes.</li>
<li>Si la mezcla consta solo de hidrocarburos (aceites), Peng-Robinson podría funcionar, pero NRTL es más seguro si no está seguro.</li>
</ul>
</section>
</section>
<section id="pasos-para-configurar-la-simulación-ejemplo-en-dwsimaspen" class="level3" data-number="1.5">
<h3 data-number="1.5"><span class="header-section-number">1.5</span> Pasos para configurar la simulación (Ejemplo en DWSIM/Aspen)</h3>
<p>Una vez elegido el software, siga este orden: - Configuración de componentes: - Agregar oleato de metilo (como componente base). - Agregar agua (si hay humedad). - Agregar el contaminante principal (por ejemplo, tolueno o un componente genérico pesado). - Selección do Paquete de Fluídos: Selecciona NRTL ou UNIQUAC.</p>
<section id="diseño-del-diagrama-de-flujo-pfd" class="level4" data-number="1.5.1">
<h4 data-number="1.5.1"><span class="header-section-number">1.5.1</span> Diseño del Diagrama de Flujo (PFD):</h4>
<ul>
<li>Creara unha Corrente de Alimentación (Feed) coa temperatura e presión atmosférica.</li>
<li>Colocar una Columna de Destilación Rigurosa.</li>
<li>Configuración de la columna:
<ul>
<li>Presión del condensador: Establecer una presión de vacío (por ejemplo, <span class="math inline">\(0,1 \text{ bar}\)</span> o <span class="math inline">\(10 \text{ kPa}\)</span>).</li>
<li>Relación de reflujo: comenzar con algo conservador, como 1,5 o 2.</li>
<li>Especificaciones: definir lo que desea obtener del fondo (el biodiesel limpio generalmente sale por el fondo si los contaminantes son volátiles, o por la parte superior si los contaminantes son lodos pesados).</li>
</ul></li>
</ul>
</section>
<section id="resumen-de-los-desafíos-clave" class="level4" data-number="1.5.2">
<h4 data-number="1.5.2"><span class="header-section-number">1.5.2</span> Resumen de los desafíos clave</h4>
<ul>
<li><strong>Nota importante</strong>: a diferencia de la recuperación de acetona o etanol, el biodiesel no se evapora fácilmente. Si sus residuos son más pesados ​​que el biodiesel (por ejemplo, resinas), tendrá que evaporar el biodiesel (mucha energía). Si los residuos son más ligeros (por ejemplo, agua, disolventes ligeros), basta con decapar o evaporar los ligeros y dejar el biodiesel líquido (mucho más eficiente).</li>
</ul>
</section>
</section>
</section>
<section id="evaporador-de-película-agitada-atfe---agitated-thin-film-evaporator" class="level2" data-number="2">
<h2 data-number="2"><span class="header-section-number">2</span> Evaporador de Película Agitada (ATFE - Agitated Thin Film Evaporator)</h2>
<p>La emppresa REGADI utiliza un evaporador de película agitada (ATFE) para la recuperación de disolventes. Este tipo de evaporador es especialmente adecuado para líquidos viscosos y sensibles al calor, como el biodiésel. El ATFE funciona creando una película delgada de líquido sobre una superficie calentada, mientras una cuchilla agita el líquido para mejorar la transferencia de calor y masa. Esto permite una rápida evaporación del disolvente volátil a temperaturas más bajas, minimizando el riesgo de degradación térmica del biodiésel. El diseño del ATFE incluye un rotor que gira a alta velocidad, creando una fuerza centrífuga que distribuye el líquido en una capa delgada. La agitación mecánica mejora la transferencia de calor al reducir la resistencia térmica en la película líquida y facilita la liberación del vapor formado. De hecho, es el equipo ideal para biodiesel sucio porque minimiza el tiempo de residencia y evita la degradación térmica (“quemar” el biodiesel), además de manejar bien la viscosidad.</p>
<p>No existe una biblioteca Python específica llamada “modelo ATFE” o similar. A diferencia de las redes neuronales o la simulación de datos (donde tiene scikit-learn), en la ingeniería de procesos en Python generalmente se debe construir el modelo de operación unitaria por uno mismo o usar libros genéricos de termodinámica para respaldar sus cálculos.</p>
<p>Para simular esto en Python, necesitará crear un modelo discreto (paso a paso) o resolver un sistema de ecuaciones diferenciales ordinarias (EDO) a lo largo del evaporador. Nosotros lo hemos abordado de la siguiente forma:</p>
<section id="la-física-del-atfe" class="level3" data-number="2.1">
<h3 data-number="2.1"><span class="header-section-number">2.1</span> La Física del ATFE</h3>
<p>El ATFE no es un tanque mixto; es un tubo largo. Se debes modelizar dividiendo el tubo en pequeñas “rodajas” o nodos (volumen de control). En cada rebanada (<span class="math inline">\(dz\)</span>), suceden tres cosas principales: 1. Transferencia de calor: desde la pared caliente (<span class="math inline">\(T_{wall}\)</span>) a la película líquida (<span class="math inline">\(T_{liq}\)</span>). 2. Evaporación: Parte del disolvente volátil se convierte en vapor debido al calor recibido. 3. Cambio de Composición: El líquido que pasa a la siguiente rebanada es más rico en biodiesel y más viscoso.</p>
<p>Las variables clave son: - <span class="math inline">\(U\)</span> (Coeficiente general de transferencia de calor): en el ATFE, este valor es alto debido a la agitación mecánica. - <span class="math inline">\(\lambda\)</span> (Calor latente de vaporización): energía requerida para evaporar el solvente.</p>
</section>
<section id="bibliotecas-python-necesarias" class="level3" data-number="2.2">
<h3 data-number="2.2"><span class="header-section-number">2.2</span> Bibliotecas Python necesarias</h3>
<p>Para hacer esto, necesitaremos: - <strong>NumPy</strong>: para manejar vectores y matrices. - <strong>SciPy</strong> (integrar): para resolver ecuaciones diferenciales (odeint o solve_ivp) si quiere ser riguroso, o simplemente un bucle for si hace un modelo de diferencias finitas. - <strong>Thermo</strong> (opcional pero recomendado): una biblioteca Python de código abierto para obtener propiedades químicas (<span class="math inline">\(Cp\)</span>, puntos de ebullición, densidad) sin tener que escribirlas a mano. (pipa instalación termo).</p>
</section>
</section>
<section id="códigos-de-simulaciónen-python" class="level2" data-number="3">
<h2 data-number="3"><span class="header-section-number">3</span> Códigos de simulaciónen python</h2>
<p>A partir de esta premisa hemos creado códigos específicos para simular el comportamiento de cada componente que forma parte de este proyecto de reciclado de ésteres y microemulsiones en las instalaciones de DROVI y REGADI. Los códigos están disponibles en el repositorio de GitHub asociado a este proyecto y se entrega copia digital con esta memoria.</p>
<p>La siumulación <code>atfe_1.py</code> simula el comportamiento del evaporador de película agitada (ATFE) para la recuperación de biodiésel a partir de una mezcla contaminada. Este código utiliza un modelo de diferencias finitas para dividir el evaporador en segmentos y calcular la transferencia de calor, la evaporación y el cambio de composición a lo largo del equipo.</p>
<p>A este modelo le falta mejorar dos puntos en el código, aunque en la actualidad no se emplean en el reciclaje de disolventes actual por parte de REGADI, pero que muy probablemente se pueda usar en el futuro es la destilación de los FAMES recuperados para su purificación final. Ello imlica tener en cuanta también ell equilibbrio vappor-líquido y la variación del coeficiente de transferencia de calor <span class="math inline">\(U\)</span> a lo largo del evaporador. Estos dos puntos son:</p>
<ul>
<li>VLE (Equilibrio vapor-líquido): hemos supuesto que la temperatura de ebullición es constante (<span class="math inline">\(45^\circ\text{C}\)</span>). De hecho, a medida que el disolvente se evapora y aumenta la concentración de biodiesel, aumenta la temperatura de ebullición de la mezcla (Elevación del punto de ebullición). Debe llamar a termo en cada paso para recalcular la temperatura de equilibrio (punto de burbuja).</li>
<li>Viscosidad y U variable: a medida que el biodiesel se concentra, la viscosidad se dispara. Esto hace que el coeficiente <span class="math inline">\(U\)</span> disminuya al final de la tubería. Un buen modelo ATFE tiene una fórmula que recalcula <span class="math inline">\(U\)</span> en función de la viscosidad local.</li>
</ul>
<p>También hay que tenr en cuenta que: - A medida que el disolvente se evapora, la mezcla se vuelve “más pesada” y la temperatura de ebulición sube (esto es crítico para no degradar el biodiesel). - La energía necesaria para evaporar (<span class="math inline">\(\Delta H_{vap}\)</span>) cambia según la composición.</p>
<p>En caso de necesitar incorporar el uso de la destilación en la simulación del reciclado de los ésteres y las microemulsiones, se recomienda utilizar el código <code>destilacion_fames.py</code> como base para la simulación de la columna de destilación, adaptándolo según las necesidades específicas del proceso y las características de la mezcla a tratar.</p>
<p>La simulación <code>destilacion_fames.py</code> modela una columna de destilación para purificar el biodiésel recuperado. Utiliza un enfoque de equilibrio de fases y balances de masa para determinar la composición del destilado y del fondo en función de las condiciones operativas de la columna. Ambos códigos están diseñados para ser flexibles y adaptarse a diferentes condiciones de operación y composiciones de alimentación, permitiendo a los usuarios optimizar el proceso de reciclaje de biodiésel.</p>
<p>En el mundo real, a medida que el disolvente (metanol/hexano) se evapora, el líquido restante se vuelve “más espeso” (más viscoso). En un ATFE, las palas del rotor giran para mantener el líquido pegado a la pared en una fina capa: - Si la viscosidad es baja (agua/metanol): el flujo es muy turbulento, la transferencia de calor (<span class="math inline">\(U\)</span>) es muy alta. - Si la viscosidad es alta (fames/resinas): el líquido se congela, la turbulencia es baja y cuesta mucho más calentar el interior. El valor de <span class="math inline">\(U\)</span> se desploma.</p>
<section id="física-cómo-modelar-la-variable-u" class="level4" data-number="3.0.1">
<h4 data-number="3.0.1"><span class="header-section-number">3.0.1</span> Física: cómo modelar la variable <span class="math inline">\(U\)</span></h4>
<p>En ingeniería química, para equipos de superficie rayada (como ATFE), se suele utilizar la teoría de la penetración o las correlaciones empíricas. Un enfoque estándar simplificado es escalar la base <span class="math inline">\(U\)</span> en función de la viscosidad:</p>
<p><span class="math display">\[
U_{local} = U_{base} \cdot \left( \frac{\mu_{base}}{\mu_{local}} \right)^n
\]</span></p>
<p>Donde <span class="math inline">\(n\)</span> suele estar entre <span class="math inline">\(0,25\)</span> y <span class="math inline">\(0,33\)</span>. Esto significa que si la viscosidad sube mucho, el <span class="math inline">\(U\)</span> baja, pero no de forma lineal (las comillas ayudan a mitigar la caída). Código Python actualizado (con viscosidad dinámica) Agregamos la lógica para leer la viscosidad (mix.mul) en cada paso y recalcular la eficiencia térmica y creamos una nueva simulación <code>afte_2.py</code> que tiene en cuenta la varción de viscosidad.</p>
<p>Cuando se ejecute este código se revela en el gráfico: - La “curva de agotamiento” de <span class="math inline">\(U\)</span>: al principio, <span class="math inline">\(U\)</span> es alto (~1500). Pero hacia el final, cuando el biodiesel es casi puro (90%+), la línea roja (viscosidad) se dispara y la línea azul (<span class="math inline">\(U\)</span>) cae. - Consecuencia práctica: Los últimos 0,5 metros del evaporador son muy ineficientes. Es mucho más difícil sacar el último 1% del disolvente que el primer 50%.</p>
<p>Lo siguiente fue preparar una simulación a nivel “industrial” contando con el Tiempo de Residencia. El biodiesel se degrada si pasa mucho tiempo caliente. Pero ante tendremos en cuenta algunas consideraciones teóricas.</p>
</section>
</section>
<section id="simulaciones-de-recuperación-de-fames-y-microemulsiones-en-aspen---hysys-y-dwsim" class="level2" data-number="4">
<h2 data-number="4"><span class="header-section-number">4</span> Simulaciones de recuperación de FAMES y microemulsiones en ASPEN - HYSYS y DWSIM</h2>
<section id="el-biodiésel-como-biosolvente-industrial" class="level3" data-number="4.1">
<h3 data-number="4.1"><span class="header-section-number">4.1</span> El Biodiésel como Biosolvente Industrial</h3>
<p>El biodiésel (FAME - Ésteres Metílicos de Ácidos Grasos) se conoce principalmente como combustible, pero en la industria química moderna está ganando terreno como “Biodisolvente Verde”. Se utiliza para sustituir disolventes derivados del petróleo (como el tolueno o xileno) en la limpieza de resinas, tintas y formulación de agroquímicos debido a: - Alto punto de inflamación: Es más seguro de manipular. - Biodegradabilidad: Menor impacto en caso de vertido. - Poder disolvente (Índice Kauri-Butanol): Muy eficaz para disolver compuestos orgánicos no polares.</p>
<p>El reto económico y ambiental es que, tras su uso, el biodiésel queda contaminado. Tirarlo es caro y contaminante; reciclarlo es obligatorio.</p>
</section>
<section id="tecnología-clave-evaporador-de-película-agitada-atfe" class="level3" data-number="4.2">
<h3 data-number="4.2"><span class="header-section-number">4.2</span> Tecnología Clave: Evaporador de Película Agitada (ATFE)</h3>
<p>Para reciclar el biodiésel, debemos separarlo de los contaminantes (pinturas, polímeros, aceites sucios). La destilación convencional (en tanque o columna) es peligrosa para el biodiésel porque requiere mantenerlo caliente mucho tiempo, lo que provoca su degradación. Aquí entra el ATFE (Agitated Thin Film Evaporator). ¿Qué es y cómo funciona?:</p>
<p>El ATFE es un intercambiador de calor de carcasa y tubos modificado. Dentro del tubo hay un rotor con aspas que gira a alta velocidad. - El líquido entra y las aspas lo “esparcen” contra la pared caliente formando una película finísima (0.5 - 2 mm). - Al ser una capa tan fina, la transmisión de calor es instantánea. Los componentes volátiles se evaporan en segundos. - El residuo pesado (o el producto purificado, dependiendo del proceso) cae por gravedad en espiral hacia el fondo.</p>
<section id="ventajas-críticas-para-el-biodiésel" class="level4" data-number="4.2.1">
<h4 data-number="4.2.1"><span class="header-section-number">4.2.1</span> Ventajas Críticas para el Biodiésel:</h4>
<ul>
<li>Tiempo de Residencia Corto: El líquido solo está dentro del equipo unos segundos (10-60 s). Esto evita que el biodiésel se “queme” u oxide.</li>
<li>Manejo de Viscosidad: Como viste en la simulación, cuando el disolvente se evapora, la viscosidad sube. Las aspas del ATFE rompen esa viscosidad, manteniendo el flujo.</li>
<li>Operación a Alto Vacío: Permite bajar drásticamente la temperatura de ebullición.</li>
</ul>
</section>
<section id="tipos-de-atfe" class="level4" data-number="4.2.2">
<h4 data-number="4.2.2"><span class="header-section-number">4.2.2</span> Tipos de ATFE:</h4>
<ul>
<li>Vertical (Más común): Usa la gravedad para bajar el producto. Ideal para destilar el solvente limpio.</li>
<li>Horizontal: Se usa cuando se quiere secar completamente un sólido (formar polvo o pasta muy seca).</li>
<li>Rotores Rígidos vs. Pendulares:
<ul>
<li>Rígidos: Mantienen una distancia fija con la pared (gap fijo).</li>
<li>Pendulares: La fuerza centrífuga pega las aspas a la pared (scrape surface), ideal si el residuo es muy pegajoso (fouling).</li>
</ul></li>
</ul>
</section>
</section>
<section id="comparativa-girasol-vs.-palma" class="level3" data-number="4.3">
<h3 data-number="4.3"><span class="header-section-number">4.3</span> Comparativa: Girasol vs. Palma</h3>
<p>No todos los biodiéseles son iguales. Su comportamiento en el reciclado y su impacto ambiental dependen de su Perfil de Ácidos Grasos.</p>
<p>Diferencias Químicas y Operativas en el ATFE</p>
<table class="caption-top">
<colgroup>
<col style="width: 36%" />
<col style="width: 34%" />
<col style="width: 29%" />
</colgroup>
<thead>
<tr class="header">
<th style="text-align: left;">Característica</th>
<th style="text-align: left;">Biodiésel de Girasol</th>
<th style="text-align: left;">Biodiésel de Palma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td style="text-align: left;">Composición Principal</td>
<td style="text-align: left;">Rico en Linoleico (C18:2). Es poliinsaturado (muchos dobles enlaces)</td>
<td style="text-align: left;">Rico en Palmítico (C16:0) y Oleico. Es saturado (cadenas estables)</td>
</tr>
<tr class="even">
<td style="text-align: left;">Estado Físico (20°C)</td>
<td style="text-align: left;">Líquido fluido</td>
<td style="text-align: left;">Semisólido o pasta (se congela fácilmente)</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Punto de Niebla (CFPP)</td>
<td style="text-align: left;">Bajo (-5°C a 0°C). Fluye bien en frío</td>
<td style="text-align: left;">Alto (+13°C a +15°C). Necesita calefacción</td>
</tr>
<tr class="even">
<td style="text-align: left;">Estabilidad Térmica</td>
<td style="text-align: left;">BAJA. Los dobles enlaces reaccionan con el oxígeno y el calor. Tiende a polimerizar (formar gomas) dentro del ATFE si se pasa de temperatura</td>
<td style="text-align: left;">ALTA. Resiste muy bien el calor sin degradarse. Es más robusto para reciclar</td>
</tr>
<tr class="odd">
<td style="text-align: left;">Reto en el Reciclado</td>
<td style="text-align: left;">Evitar la oxidación. Requiere vacío más profundo y temperaturas más bajas en el ATFE</td>
<td style="text-align: left;">Evitar que se solidifique. Requiere eléctrico (calefacción) en todas las tuberías y bombas</td>
</tr>
</tbody>
</table>
</section>
<section id="diagrama-de-bloques-del-proceso-de-reciclado" class="level3" data-number="4.4">
<h3 data-number="4.4"><span class="header-section-number">4.4</span> Diagrama de Bloques del Proceso de Reciclado</h3>
<p><img src="../03_Recursos_Graficos/diagrama_bloques_reciclado_biodiesel.png" class="img-fluid" /></p>
</section>
<section id="implicaciones-ambientales-lca---análisis-de-ciclo-de-vida" class="level3" data-number="4.5">
<h3 data-number="4.5"><span class="header-section-number">4.5</span> Implicaciones Ambientales (LCA - Análisis de Ciclo de Vida)</h3>
<p>El origen de la materia prima define la “mochila ecológica” del disolvente reciclado.</p>
</section>
<section id="biodiésel-de-girasol" class="level3" data-number="4.6">
<h3 data-number="4.6"><span class="header-section-number">4.6</span> Biodiésel de Girasol</h3>
<ul>
<li>Impacto de Uso de Suelo: Se cultiva extensivamente en Europa (España, Francia, Ucrania). Su huella de transporte es baja si la planta de reciclado está en Europa.</li>
<li>Huella de Carbono: Generalmente menor debido al transporte reducido.</li>
<li>Crítica: Menor rendimiento por hectárea que la palma, requiere más tierra para producir la misma cantidad de aceite.</li>
</ul>
</section>
<section id="biodiésel-de-palma" class="level3" data-number="4.7">
<h3 data-number="4.7"><span class="header-section-number">4.7</span> Biodiésel de Palma</h3>
<p>Es un aceite que podríamos denominar eficiente pero polémico.- Rendimiento: Es el cultivo oleaginoso más eficiente del mundo (produce 5-10 veces más aceite por hectárea que el girasol). Impacto Ambiental: Históricamente asociado a la deforestación de selvas tropicales (Indonesia, Malasia) y pérdida de biodiversidad (orangutanes). Certificación: Si se usa palma, industrialmente se exige certificado RSPO (Roundtable on Sustainable Palm Oil) para asegurar que no proviene de deforestación reciente. Transporte: Alta huella de carbono logística para traerlo a plantas de reciclaje en Occidente.</p>
</section>
<section id="resumen-del-proceso-de-reciclado" class="level3" data-number="4.8">
<h3 data-number="4.8"><span class="header-section-number">4.8</span> Resumen del Proceso de Reciclado</h3>
<p>El diagrama de bloques del proceso completo sería: - Recepción: Biodiésel sucio (con tintas/resinas) - Filtración Previa: Eliminar virutas metálicas o sólidos grandes (&gt;100 micras) para no dañar el rotor del ATFE. - Evaporación Flash (Opcional): Si trae agua o disolventes muy ligeros (acetona), se quitan aquí. - Unidad ATFE (Corazón del proceso): - Entrada: Biodiésel Sucio.Condiciones: Vacío (10-50 mbar) y Tª (160-180°C). - Salida Vapor: Biodiésel puro (se condensa y recupera). - Salida Fondos: Lodos concentrados (residuos de resina/pintura) para gestión de residuos externos. - Control de Calidad: Comprobar acidez y contenido de agua para validar su reutilización.</p>
<section id="cómo-te-contempla-esto-en-una-simulación-python" class="level4" data-number="4.8.1">
<h4 data-number="4.8.1"><span class="header-section-number">4.8.1</span> ¿Cómo te contempla esto en una simulación Python?</h4>
<p>Hemos refinado el código Python: - Si simulamos Girasol: Debemos vigilar que la temperatura de pared (<span class="math inline">\(T_{wall}\)</span>) no sea excesiva, o añadir una función de “pérdida por degradación”. - Si simulamoss Palma: No hay que preocuparse tanto por la degradación, pero se debe vigilar la Viscosidad a temperaturas bajas (si el líquido se enfría, la viscosidad se dispara exponencialmente y bloquea el equipo).</p>
</section>
</section>
</section>
<section id="reciclado-de-ésteres-dibásicos" class="level2" data-number="5">
<h2 data-number="5"><span class="header-section-number">5</span> Reciclado de ésteres dibásicos</h2>
<section id="qué-son-los-ésteres-dibásicos-dbe" class="level3" data-number="5.1">
<h3 data-number="5.1"><span class="header-section-number">5.1</span> ¿Qué son los Ésteres Dibásicos (DBE)?</h3>
<p>Los DBE (Dibasic Esters) son una familia de disolventes oxigenados derivados de ácidos dicarboxílicos. Industrialmente, rara vez se usan puros; suelen ser una mezcla de tres ésteres metílicos purificados (la fracción “AGS”): - Dimetil Adipato (C6) - Dimetil Glutarato (C5) - Dimetil Succinato (C4)</p>
<p>¿Por qué son “Disolventes Verdes”?: - Baja Presión de Vapor: Se evaporan muy lentamente (bajos COV - Compuestos Orgánicos Volátiles), lo que reduce la inhalación por parte de los trabajadores. - Biodegradabilidad: Se degradan fácilmente en el medio ambiente. - No son inflamables (generalmente): Tienen puntos de inflamación altos (<span class="math inline">\(&gt;100^\circ\text{C}\)</span>), similares al biodiésel. - Sustitución: Se usan para reemplazar disolventes tóxicos o clorados (como el Cloruro de Metileno o la NMP) en decapado de pinturas, limpieza de resinas y limpieza de moldes de poliuretano.</p>
</section>
<section id="el-reciclado-de-dbes" class="level3" data-number="5.2">
<h3 data-number="5.2"><span class="header-section-number">5.2</span> El Reciclado de DBEs</h3>
<p>Recuperar DBE es muy rentable porque es un disolvente caro (más que el biodiésel). #### Proceso en ATFE</p>
<p>El comportamiento en un evaporador de película agitada es excelente, pero con una diferencia clave respecto al biodiésel: - Punto de Ebullición:Los DBE hierven entre 196°C y 225°C (a presión atmosférica). Esto es más bajo que el biodiésel (<span class="math inline">\(&gt;300^\circ\text{C}\)</span>), pero mucho más alto que el agua o el acetona. - Hidrólisis (El enemigo oculto): Si el residuo sucio contiene agua y el pH es ácido o básico, al calentar en el ATFE, el éster se rompe (hidrólisis), volviendo a formarse ácido adípico/glutárico (que son corrosivos) y metanol. - Solución: Es obligatorio neutralizar el pH y eliminar el agua (Flash previo) antes de meterlo al ATFE caliente.</p>
</section>
<section id="la-mezcla-dbe-fame-retos-de-interacción" class="level3" data-number="5.3">
<h3 data-number="5.3"><span class="header-section-number">5.3</span> La Mezcla DBE + FAME: Retos de Interacción</h3>
<p>En la industria es común encontrar mezclas (blends) de DBE + FAME. Se mezclan a propósito para obtener un disolvente con “doble acción”: el DBE ataca la resina y el Biodiésel aporta lubricidad y mantiene la suciedad en suspensión.</p>
<p>Al intentar reciclar esta mezcla, surgen complicaciones termodinámicas:</p>
<section id="diferencia-de-volatilidad-separación" class="level4" data-number="5.3.1">
<h4 data-number="5.3.1"><span class="header-section-number">5.3.1</span> Diferencia de Volatilidad (Separación)</h4>
<p>Termodinámicamente, no son difíciles de separar entre sí si tienes una buena columna, pero en un ATFE (que tiene solo una etapa teórica de equilibrio) es complejo obtener cortes puros.DBE: - Hierve a <span class="math inline">\(\approx 200^\circ\text{C}\)</span>. - FAME: Hierve a <span class="math inline">\(\approx 350^\circ\text{C}\)</span>.</p>
<p>En un solo paso de ATFE: - Si se ajusta la temperatura para evaporar el DBE, el biodiésel se quedará en el fondo con los residuos (se pierde biodiésel). - Si se sube la temperatura para evaporar también el biodiésel, ambos saldrán mezclados por el tope (recuperas el disolvente mezcla, pero no los separas). - Nota: A menudo, recuperar la mezcla “Sucia pero destilada” es aceptable para volver a usarla en limpieza industrial.</p>
</section>
<section id="azeótropos-y-no-idealidad" class="level4" data-number="5.3.2">
<h4 data-number="5.3.2"><span class="header-section-number">5.3.2</span> Azeótropos y No-Idealidad</h4>
<p>En este caso es donde la simulación (UNIQUAC/NRTL) es vital. - Azeótropos con Agua: Tanto los DBE como el Biodiésel forman azeótropos con el agua. Esto significa que es difícil secarlos completamente solo con evaporación; siempre arrastran humedad, lo que fomenta la corrosión ácida. - Interacción DBE-Biodiésel: - Químicamente son muy similares (polares, ésteres). Generalmente forman una mezcla zeotrópica (no azeotrópica), lo cual es bueno. Siguen la Ley de Raoult con desviaciones moderadas. - El riesgo de la Transesterificación Cruzada: - Si la mezcla caliente contiene trazas de catalizador (ej. sosa cáustica de una limpieza anterior o metóxido), los grupos metilo pueden “saltar” de una molécula a otra. Aunque termodinámicamente no cambia mucho la mezcla (ambos son metil-ésteres), químicamente estás creando moléculas híbridas impredecibles. #### Polimerización Cruzada</p>
<p>Si el residuo contiene pinturas o resinas de poliuretano: - Los DBE son excelentes disolventes de poliuretano. - Al concentrar el residuo en el fondo del ATFE, la concentración de resina sube. - A altas temperaturas, el biodiésel (especialmente el de girasol) puede actuar como agente de curado o polimerizar con los residuos disueltos por el DBE, creando un gel sólido que puede bloquear el rotor del ATFE.</p>
</section>
</section>
<section id="implementación-en-la-simulación-python" class="level3" data-number="5.4">
<h3 data-number="5.4"><span class="header-section-number">5.4</span> Implementación en la Simulación Python</h3>
<p>La incorporación de los ésteres dibásicos (DBE) a la simulación es un paso importante porque pasamos de una mezcla binaria (Disolvente/FAME) a una Mezcla Ternaria (o Multicomponente). El comportamiento cambia drásticamente: - El Ligero (ej. Metanol/Agua): Se evapora casi instantáneamente al entrar. - El Medio (DBE - Dimetil Adipato): Es el “componente difícil”. Tiene un punto de ebullición alto (~227°C). Si nos pasamos de calor, lo evaporamos (se pierde por arriba); si nos quedam os cortos, se queda en el biodiésel. - El Pesado (Biodiésel - Oleato): Debería quedarse líquido.</p>
<p>Para simular esto, se debe añadir un componente representativo de los DBE. El Dimetil Adipato es el mejor candidato estándar. Podríiamos crear un nuevo archivo <code>atfe_dbe_fame.py</code> que incluya: - Componentes: FAME (oleato de metilo) + Dimetil Adipato + Agua + Contaminante (tolueno o resina). - Modelo Termodinámico: NRTL o UNIQUAC para capturar las interacciones. - Lógica de Hidrólisis: Si el pH &lt; 6 o &gt; 8 y hay agua, añadir una “pérdida” de DBE proporcional a la temperatura y tiempo de residencia. - Control de Viscosidad: Similar al código anterior, pero considerando la mezcla DBE-FAME.<br />
- Salida: Composición del vapor (recuperado) y del fondo (residuo).</p>
<section id="el-reto-matemático-composición-del-vapor-y_i" class="level4" data-number="5.4.1">
<h4 data-number="5.4.1"><span class="header-section-number">5.4.1</span> El Reto Matemático: Composición del Vapor (<span class="math inline">\(y_i\)</span>)</h4>
<p>En el código anterior asumíamos que solo evaporaba el disolvente. Ahora, todo puede evaporarse según su presión de vapor.Usaremos el cálculo de equilibrio de fases (<span class="math inline">\(y_i\)</span> vs <span class="math inline">\(x_i\)</span>) de <code>thermo</code> para determinar qué composición exacta tiene el vapor que estamos retirando en cada centímetro del tubo.</p>
<p>Hemos creado otro simulador <code>atfe_dbe_fame_vle.py</code> que incluye este cálculo de equilibrio. En cada paso: - Calculamos la composición líquida actual (<span class="math inline">\(x_i\)</span>). - Usamos <code>thermo</code> para obtener las presiones de vapor parciales y calcular la composición del vapor (<span class="math inline">\(y_i\)</span>). - Ajustamos las tasas de evaporación de cada componente según su fracción en el vapor.</p>
<p>Con estas consideraciones, el código permitirá simular y optimizar el proceso de reciclado de mezclas DBE-FAME en un ATFE, ayudando a maximizar la recuperación de disolventes y minimizar los riesgos operativos.</p>
</section>
<section id="interpretación-de-los-resultados" class="level4" data-number="5.4.2">
<h4 data-number="5.4.2"><span class="header-section-number">5.4.2</span> Interpretación de los Resultados</h4>
<p>Cuando se ejecuta este código, en la Gráfica 1 (Composición) se verás la “guerra” de volatilidades relativas: - Metanol (Línea Roja punteada): - Caerá a cero muy rápido (en los primeros 0.5 o 1 metro). - Es tan volátil que el vacío se lo lleva enseguida. - DBE (Línea Azul): - Al principio, su concentración sube. ¿Por qué? Porque estamos quitando metanol, así que porcentualmente el DBE y el Biodiésel aumentan. - Una vez que el metanol desaparece, la temperatura sube. Si la <span class="math inline">\(T_{pared}\)</span> es suficientemente alta, empezarás a ver cómo la línea azul empieza a bajar. Eso significa que estás evaporando el DBE (recuperándolo por arriba). - Biodiésel (Línea Verde): Debería subir constantemente hasta acercarse al 100% (o al valor que desees) en el fondo.</p>
</section>
<section id="experimentación-cómo-jugar-con-el-código" class="level4" data-number="5.4.3">
<h4 data-number="5.4.3"><span class="header-section-number">5.4.3</span> Experimentación: ¿Cómo “jugar” con el código?</h4>
<p>Si se quiere separar el DBE del Biodiésel: - Subir T_wall_C a 190°C o 200°C. y la línea azul (DBE) caerá al final del tubo (se va al vapor). - Si quieres limpiar el disolvente (DBE+Biodiésel) de impurezas ligeras:Baja T_wall_C a 140°C. El Metanol desaparecerá, pero el DBE se mantendrá líquido junto con el Biodiésel (la línea azul se mantendrá alta).</p>
<section id="nota-sobre-azeótropos" class="level5" data-number="5.4.3.1">
<h5 data-number="5.4.3.1"><span class="header-section-number">5.4.3.1</span> Nota sobre Azeótropos</h5>
<p>El código actual usa thermo, que tiene modelos de coeficientes de actividad (como UNIFAC o NRTL modificados internamente si están disponibles). Si existen azeótropos conocidos en la base de datos entre estos componentes, el cálculo mix.flash ya los está teniendo en cuenta implícitamente.Ejemplo: Si hubiera un azeótropo Metanol-DBE, verías que no puedes bajar la concentración de uno de ellos a cero sin arrastrar el otro.</p>
<p>La simulación se mejoró también par acalcular la potencia consumida en el proceso. El cálculo de la potencia del rotor es fundamental. En plantas reales de reciclado de biodiésel, este es a menudo el “cuello de botella”.</p>
<p>Si el residuo se vuelve demasiado viscoso (como una goma o pegamento) al final del tubo, el motor eléctrico sufrirá. Si no está bien dimensionado, saltarán las protecciones térmicas y la planta se parará.</p>
</section>
</section>
</section>
<section id="la-física-cuánta-energía-cuesta-mover-las-aspas" class="level3" data-number="5.5">
<h3 data-number="5.5"><span class="header-section-number">5.5</span> La Física: ¿Cuánta energía cuesta mover las aspas?</h3>
<p>El consumo de potencia en un ATFE se debe principalmente al Cizallamiento Viscoso (arrastrar las palas a través del líquido).La fórmula de ingeniería simplificada para cada sección del tubo es:</p>
<p><span class="math display">\[
P_{corte} = \mu \cdot A \cdot \frac{v^2}{\delta}
\]</span></p>
<p>Donde:<span class="math inline">\(\mu\)</span>: Viscosidad dinámica local (Pa·s) [Calculada por thermo].<span class="math inline">\(A\)</span>: Área de la sección (<span class="math inline">\(m^2\)</span>).<span class="math inline">\(v\)</span>: Velocidad periférica de la pala (<span class="math inline">\(m/s\)</span>).<span class="math inline">\(\delta\)</span>: Espesor de la película o “gap” entre pala y pared (m).</p>
<p>El código <code>atfe_dbe_fame_poterncia.py</code> incluye el cálculo del consumo energético del ATFE basado en la transferencia de calor necesaria para evaporar los componentes volátiles. Este cálculo es crucial para evaluar la viabilidad económica del proceso de reciclado.</p>
</section>
<section id="interpretación-de-la-simulación" class="level3" data-number="5.6">
<h3 data-number="5.6"><span class="header-section-number">5.6</span> Interpretación de la simulación</h3>
<section id="la-correlación-viscosidad-potencia" class="level4" data-number="5.6.1">
<h4 data-number="5.6.1"><span class="header-section-number">5.6.1</span> La correlación Viscosidad-Potencia</h4>
<p>La línea roja (Potencia) debiera ser casi idéntica en forma a la azul (Viscosidad). Esto confirma que el consumo eléctrico es un “sensor” indirecto de cuán espeso está el producto.</p>
</section>
<section id="el-peligro-del-fondo" class="level4" data-number="5.6.2">
<h4 data-number="5.6.2"><span class="header-section-number">5.6.2</span> El peligro del fondo</h4>
<p>Si la línea roja se dispara exponencialmente en los últimos 0.5 metros, tienes un problema de diseño,lo que significa que el residuo se está volviendo demasiado viscoso., o sea que se está secando demasiado el residuo, lo cual es un riesgo ya que los FAMEs polimerizados puede bloquear el rotor (stall) o quemar el motor. La solución podría ser dejar un poco más de DBE o Biodiésel en el fondo (no intentar llegar al 100% de pureza) para que actúe como lubricante.</p>
</section>
<section id="tabla-comparativa-técnica" class="level4" data-number="5.6.3">
<h4 data-number="5.6.3"><span class="header-section-number">5.6.3</span> Tabla Comparativa Técnica</h4>
<p>Los resultados que obtendrías en la simulación (usando methyl linoleate vs methyl palmitate) con la realidad operativa en planta permiten elaborar la siguiente tabla comparativa.</p>
<table class="caption-top">
<colgroup>
<col style="width: 17%" />
<col style="width: 40%" />
<col style="width: 42%" />
</colgroup>
<thead>
<tr class="header">
<th>Variable de Ingeniería</th>
<th>Biodiésel de Girasol</th>
<th>Biodiésel de Palma</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Componente Clave (Simulación)</td>
<td>Metil Linoleato (C18:2)</td>
<td>Metil Palmitato (C16:0)</td>
</tr>
<tr class="even">
<td>Estructura Molecular</td>
<td>Cadena larga con 2 dobles enlaces (“kinks”). Molécula “doblada”.</td>
<td>Cadena saturada lineal. Molécula “recta” y empaquetada.</td>
</tr>
<tr class="odd">
<td>Viscosidad (100∘C)</td>
<td>Baja. Fluye muy bien incluso concentrado.</td>
<td>Media/Alta. Al ser saturado, es más espeso.</td>
</tr>
<tr class="even">
<td>Punto de Fusión / Fluidez</td>
<td>−5∘C (Líquido siempre).</td>
<td>+30∘C (Tiende a solidificar en líneas frías).</td>
</tr>
<tr class="odd">
<td>Sensibilidad Térmica (Degradación)</td>
<td>Muy Alta. Los dobles enlaces reaccionan con el calor.</td>
<td>Baja. Muy estable y robusto.</td>
</tr>
<tr class="even">
<td>Riesgo Principal en ATFE</td>
<td>Fouling por Polimerización. Si Tpared​&gt;180∘C, se forman gomas (barniz) en la pared.</td>
<td>Bloqueo por Enfriamiento. Si el residuo se enfría al salir, se hace una “vela” sólida.</td>
</tr>
<tr class="odd">
<td>Potencia del Rotor (Simulada)</td>
<td>Menor consumo (el líquido lubrica bien).</td>
<td>Mayor consumo (+15-20%) debido a la mayor viscosidad.</td>
</tr>
<tr class="even">
<td>Estrategia de Operación</td>
<td>Maximizar Vacío (&lt;10 mbar) para bajar la Tª de ebullición.</td>
<td>Mantener traceado eléctrico en la descarga de fondo.</td>
</tr>
</tbody>
</table>
</section>
</section>
<section id="simulación-con-aceite-de-palma-en-vez-de-girasol" class="level3" data-number="5.7">
<h3 data-number="5.7"><span class="header-section-number">5.7</span> Simulación con aceite de palma en vez de girasol</h3>
<p>La palma es rica en ácidos saturados. Usaremos el Metil Palmitato.</p>
<p>Simplemente habría que cambiar el el código python lo siguiente:</p>
<pre><code># Escenario PALMA
# Sustituimos &#39;methyl oleate&#39; por &#39;methyl palmitate&#39;
comps = [&#39;methanol&#39;, &#39;dimethyl adipate&#39;, &#39;methyl palmitate&#39;]

# Nota para la simulación:
# Verás que la viscosidad (mu_liq) calculada por &#39;thermo&#39; será mayor.
# Esto hará que el cálculo de &#39;Power_segment_Watts&#39; suba.</code></pre>
<section id="interpretación-de-resultados" class="level4" data-number="5.7.1">
<h4 data-number="5.7.1"><span class="header-section-number">5.7.1</span> Interpretación de Resultados</h4>
<p>Si se ejecutan ambos escenarios y se comparan las gráficas de Potencia, se puede concluir lo siguiente: - Eficiencia Energética: El reciclado de biodiésel de girasol consume menos electricidad en el motor del ATFE porque el fluido ofrece menos resistencia al cizallamiento. - Ventana Operativa: - El Girasol tiene una ventana estrecha por arriba (límite de temperatura). - La Palma tiene una ventana estrecha por abajo (límite de solidificación). - Calidad del Destilado: Debido a la estabilidad, es más probable obtener un disolvente reciclado de Palma con menos acidez (menos degradación) que uno de Girasol, a menos que el equipo de vacío funcione perfectamente.</p>
</section>
</section>
</section>
<section id="conclusiones" class="level2" data-number="6">
<h2 data-number="6"><span class="header-section-number">6</span> Conclusiones</h2>
<section id="conclusiones-del-estudio" class="level3" data-number="6.1">
<h3 data-number="6.1"><span class="header-section-number">6.1</span> Conclusiones del Estudio</h3>
<p>El presente informe evalúa la viabilidad técnica de la recuperación biosolventes (Biodiésel y Ésteres Dibásicos) mediante evaporación en película agitada (ATFE). A través del modelado computacional en Python, integrando termodinámica de equilibrio de fases y mecánica de fluidos, se han alcanzado las siguientes conclusiones: - Idoneidad de la Tecnología ATFE:La simulación confirma que el ATFE es el equipo crítico e insustituible para este proceso. La combinación de alto vacío (&lt;50 mbar) y tiempos de residencia cortos es la única vía para separar los contaminantes sin provocar la degradación térmica (oxidación) del biodiésel ni la hidrólisis de los ésteres dibásicos (DBE). - Influencia Crítica de la Materia Prima (Girasol vs. Palma):El perfil de ácidos grasos determina la estrategia operativa: - El Biodiésel de Girasol (Linoleico) presenta ventajas mecánicas (menor viscosidad y consumo de potencia en el rotor), pero impone un límite térmico estricto (<span class="math inline">\(T_{pared} &lt; 170^\circ\text{C}\)</span>) debido a su alta tendencia a la polimerización en caliente. - El Biodiésel de Palma (Palmítico) ofrece una gran estabilidad térmica, permitiendo operaciones más agresivas, pero requiere un mayor consumo energético en el motor (+15-20%) y sistemas de calentamiento auxiliar (traceado) para evitar la solidificación del residuo en la descarga. - Dinámica de la Recuperación de DBEs:La recuperación de Ésteres Dibásicos en mezcla con biodiésel es termodinámicamente viable pero compleja. La simulación demuestra que existe una “ventana operativa” estrecha: se requiere una temperatura de pared suficiente para evaporar el DBE (P.eb. <span class="math inline">\(\approx 200^\circ\text{C}\)</span>), pero el aumento de viscosidad resultante al secar el fondo reduce drásticamente el coeficiente de transferencia de calor (<span class="math inline">\(U\)</span>), limitando la eficiencia en los últimos tramos del evaporador. - Consumo Energético:El modelo electromecánico desarrollado revela que el consumo de potencia del rotor no es lineal. Se dispara exponencialmente en el último tercio del equipo a medida que aumenta la concentración de sólidos y la viscosidad. Esto subraya la importancia de no intentar secar el residuo al 100%, dejando un remanente de disolvente como lubricante para proteger el equipo.5.2.</p>
</section>
<section id="recomendaciones-para-trabajos-futuros" class="level3" data-number="6.2">
<h3 data-number="6.2"><span class="header-section-number">6.2</span> Recomendaciones para Trabajos Futuros</h3>
<p>Para avanzar desde esta simulación teórica hacia una implementación industrial, se sugieren las siguientes líneas de acción: - Validación Experimental en Planta Piloto: Se recomienda realizar ensayos con muestras reales de disolvente sucio en un ATFE a escala laboratorio (<span class="math inline">\(0.05 - 0.1 m^2\)</span>) para validar los coeficientes de transferencia de calor (<span class="math inline">\(U\)</span>) calculados y ajustar el exponente de viscosidad (<span class="math inline">\(n\)</span>) del modelo. - Análisis de Ciclo de Vida (LCA): Realizar un estudio comparativo de la huella de carbono entre el proceso de reciclado propuesto y la incineración del residuo. El estudio debe cuantificar si el ahorro de emisiones por no producir disolvente virgen compensa el consumo eléctrico de las bombas de vacío y el calentamiento del ATFE. - Diseño del Sistema de Vacío: Dado que se evaporan compuestos orgánicos volátiles (VOCs), se recomienda estudiar la implementación de bombas de vacío de tornillo seco en lugar de anillo líquido, para evitar la generación de agua residual contaminada. - Integración Energética: Evaluar la posibilidad de utilizar el calor latente de los vapores de disolvente recuperados (que salen a <span class="math inline">\(&gt;100^\circ\text{C}\)</span>) para precalentar la alimentación, mejorando la eficiencia global de la planta.</p>
<div id="quarto-navigation-envelope" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1zaWRlYmFyLXRpdGxl">Proxecto AGROSOLVENTS</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXItdGl0bGU=">Proxecto AGROSOLVENTS</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6UmVzdW1vIEV4ZWN1dGl2bw==">Resumo Executivo</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L21lbW9yaWFfZmluYWwuaHRtbA==">/memoria_final.html</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6U2VjY2nDs25z">Seccións</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6SW50cm9kdWNpw7Nu">Introdución</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLWludC1uYXZiYXI6L0luZm9ybWVfRmluYWxfSW52ZXN0aWdhY2lvbl9BZ3Jvc29sdmVudHMubWQ=">/Informe_Final_Investigacion_Agrosolvents.md</span></p>
</div>
<div id="quarto-meta-markdown" class="hidden">
<p><span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGF0aXRsZQ==">Proxecto AGROSOLVENTS</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkdGl0bGU=">Proxecto AGROSOLVENTS</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZHRpdGxl">Proxecto AGROSOLVENTS</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW1ldGFzaXRlbmFtZQ==">Proxecto AGROSOLVENTS</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLXR3aXR0ZXJjYXJkZGVzYw==">Informe final de investigación - Universidade de Vigo</span> <span class="hidden quarto-markdown-envelope-contents" data-render-id="cXVhcnRvLW9nY2FyZGRkZXNj">Informe final de investigación - Universidade de Vigo</span></p>
</div>
</section>
</section>

</main> <!-- /main -->
<script id = "quarto-html-after-body" type="application/javascript">
  window.document.addEventListener("DOMContentLoaded", function (event) {
    const icon = "";
    const anchorJS = new window.AnchorJS();
    anchorJS.options = {
      placement: 'right',
      icon: icon
    };
    anchorJS.add('.anchored');
    const isCodeAnnotation = (el) => {
      for (const clz of el.classList) {
        if (clz.startsWith('code-annotation-')) {                     
          return true;
        }
      }
      return false;
    }
    const onCopySuccess = function(e) {
      // button target
      const button = e.trigger;
      // don't keep focus
      button.blur();
      // flash "checked"
      button.classList.add('code-copy-button-checked');
      var currentTitle = button.getAttribute("title");
      button.setAttribute("title", "Copied!");
      let tooltip;
      if (window.bootstrap) {
        button.setAttribute("data-bs-toggle", "tooltip");
        button.setAttribute("data-bs-placement", "left");
        button.setAttribute("data-bs-title", "Copied!");
        tooltip = new bootstrap.Tooltip(button, 
          { trigger: "manual", 
            customClass: "code-copy-button-tooltip",
            offset: [0, -8]});
        tooltip.show();    
      }
      setTimeout(function() {
        if (tooltip) {
          tooltip.hide();
          button.removeAttribute("data-bs-title");
          button.removeAttribute("data-bs-toggle");
          button.removeAttribute("data-bs-placement");
        }
        button.setAttribute("title", currentTitle);
        button.classList.remove('code-copy-button-checked');
      }, 1000);
      // clear code selection
      e.clearSelection();
    }
    const getTextToCopy = function(trigger) {
      const outerScaffold = trigger.parentElement.cloneNode(true);
      const codeEl = outerScaffold.querySelector('code');
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
    }
    const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
      text: getTextToCopy
    });
    clipboard.on('success', onCopySuccess);
    if (window.document.getElementById('quarto-embedded-source-code-modal')) {
      const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
        text: getTextToCopy,
        container: window.document.getElementById('quarto-embedded-source-code-modal')
      });
      clipboardModal.on('success', onCopySuccess);
    }
      var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
      var mailtoRegex = new RegExp(/^mailto:/);
        var filterRegex = new RegExp('/' + window.location.host + '/');
      var isInternal = (href) => {
          return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
      }
      // Inspect non-navigation links and adorn them if external
     var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
      for (var i=0; i<links.length; i++) {
        const link = links[i];
        if (!isInternal(link.href)) {
          // undo the damage that might have been done by quarto-nav.js in the case of
          // links that we want to consider external
          if (link.dataset.originalHref !== undefined) {
            link.href = link.dataset.originalHref;
          }
        }
      }
    function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
      const config = {
        allowHTML: true,
        maxWidth: 500,
        delay: 100,
        arrow: false,
        appendTo: function(el) {
            return el.parentElement;
        },
        interactive: true,
        interactiveBorder: 10,
        theme: 'quarto',
        placement: 'bottom-start',
      };
      if (contentFn) {
        config.content = contentFn;
      }
      if (onTriggerFn) {
        config.onTrigger = onTriggerFn;
      }
      if (onUntriggerFn) {
        config.onUntrigger = onUntriggerFn;
      }
      window.tippy(el, config); 
    }
    const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
    for (var i=0; i<noterefs.length; i++) {
      const ref = noterefs[i];
      tippyHover(ref, function() {
        // use id or data attribute instead here
        let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
        try { href = new URL(href).hash; } catch {}
        const id = href.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note) {
          return note.innerHTML;
        } else {
          return "";
        }
      });
    }
    const xrefs = window.document.querySelectorAll('a.quarto-xref');
    const processXRef = (id, note) => {
      // Strip column container classes
      const stripColumnClz = (el) => {
        el.classList.remove("page-full", "page-columns");
        if (el.children) {
          for (const child of el.children) {
            stripColumnClz(child);
          }
        }
      }
      stripColumnClz(note)
      if (id === null || id.startsWith('sec-')) {
        // Special case sections, only their first couple elements
        const container = document.createElement("div");
        if (note.children && note.children.length > 2) {
          container.appendChild(note.children[0].cloneNode(true));
          for (let i = 1; i < note.children.length; i++) {
            const child = note.children[i];
            if (child.tagName === "P" && child.innerText === "") {
              continue;
            } else {
              container.appendChild(child.cloneNode(true));
              break;
            }
          }
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(container);
          }
          return container.innerHTML
        } else {
          if (window.Quarto?.typesetMath) {
            window.Quarto.typesetMath(note);
          }
          return note.innerHTML;
        }
      } else {
        // Remove any anchor links if they are present
        const anchorLink = note.querySelector('a.anchorjs-link');
        if (anchorLink) {
          anchorLink.remove();
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        if (note.classList.contains("callout")) {
          return note.outerHTML;
        } else {
          return note.innerHTML;
        }
      }
    }
    for (var i=0; i<xrefs.length; i++) {
      const xref = xrefs[i];
      tippyHover(xref, undefined, function(instance) {
        instance.disable();
        let url = xref.getAttribute('href');
        let hash = undefined; 
        if (url.startsWith('#')) {
          hash = url;
        } else {
          try { hash = new URL(url).hash; } catch {}
        }
        if (hash) {
          const id = hash.replace(/^#\/?/, "");
          const note = window.document.getElementById(id);
          if (note !== null) {
            try {
              const html = processXRef(id, note.cloneNode(true));
              instance.setContent(html);
            } finally {
              instance.enable();
              instance.show();
            }
          } else {
            // See if we can fetch this
            fetch(url.split('#')[0])
            .then(res => res.text())
            .then(html => {
              const parser = new DOMParser();
              const htmlDoc = parser.parseFromString(html, "text/html");
              const note = htmlDoc.getElementById(id);
              if (note !== null) {
                const html = processXRef(id, note);
                instance.setContent(html);
              } 
            }).finally(() => {
              instance.enable();
              instance.show();
            });
          }
        } else {
          // See if we can fetch a full url (with no hash to target)
          // This is a special case and we should probably do some content thinning / targeting
          fetch(url)
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.querySelector('main.content');
            if (note !== null) {
              // This should only happen for chapter cross references
              // (since there is no id in the URL)
              // remove the first header
              if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
                note.children[0].remove();
              }
              const html = processXRef(null, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      }, function(instance) {
      });
    }
        let selectedAnnoteEl;
        const selectorForAnnotation = ( cell, annotation) => {
          let cellAttr = 'data-code-cell="' + cell + '"';
          let lineAttr = 'data-code-annotation="' +  annotation + '"';
          const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
          return selector;
        }
        const selectCodeLines = (annoteEl) => {
          const doc = window.document;
          const targetCell = annoteEl.getAttribute("data-target-cell");
          const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
          const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
          const lines = annoteSpan.getAttribute("data-code-lines").split(",");
          const lineIds = lines.map((line) => {
            return targetCell + "-" + line;
          })
          let top = null;
          let height = null;
          let parent = null;
          if (lineIds.length > 0) {
              //compute the position of the single el (top and bottom and make a div)
              const el = window.document.getElementById(lineIds[0]);
              top = el.offsetTop;
              height = el.offsetHeight;
              parent = el.parentElement.parentElement;
            if (lineIds.length > 1) {
              const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
              const bottom = lastEl.offsetTop + lastEl.offsetHeight;
              height = bottom - top;
            }
            if (top !== null && height !== null && parent !== null) {
              // cook up a div (if necessary) and position it 
              let div = window.document.getElementById("code-annotation-line-highlight");
              if (div === null) {
                div = window.document.createElement("div");
                div.setAttribute("id", "code-annotation-line-highlight");
                div.style.position = 'absolute';
                parent.appendChild(div);
              }
              div.style.top = top - 2 + "px";
              div.style.height = height + 4 + "px";
              div.style.left = 0;
              let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
              if (gutterDiv === null) {
                gutterDiv = window.document.createElement("div");
                gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
                gutterDiv.style.position = 'absolute';
                const codeCell = window.document.getElementById(targetCell);
                const gutter = codeCell.querySelector('.code-annotation-gutter');
                gutter.appendChild(gutterDiv);
              }
              gutterDiv.style.top = top - 2 + "px";
              gutterDiv.style.height = height + 4 + "px";
            }
            selectedAnnoteEl = annoteEl;
          }
        };
        const unselectCodeLines = () => {
          const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
          elementsIds.forEach((elId) => {
            const div = window.document.getElementById(elId);
            if (div) {
              div.remove();
            }
          });
          selectedAnnoteEl = undefined;
        };
          // Handle positioning of the toggle
      window.addEventListener(
        "resize",
        throttle(() => {
          elRect = undefined;
          if (selectedAnnoteEl) {
            selectCodeLines(selectedAnnoteEl);
          }
        }, 10)
      );
      function throttle(fn, ms) {
      let throttle = false;
      let timer;
        return (...args) => {
          if(!throttle) { // first call gets through
              fn.apply(this, args);
              throttle = true;
          } else { // all the others get throttled
              if(timer) clearTimeout(timer); // cancel #2
              timer = setTimeout(() => {
                fn.apply(this, args);
                timer = throttle = false;
              }, ms);
          }
        };
      }
        // Attach click handler to the DT
        const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
        for (const annoteDlNode of annoteDls) {
          annoteDlNode.addEventListener('click', (event) => {
            const clickedEl = event.target;
            if (clickedEl !== selectedAnnoteEl) {
              unselectCodeLines();
              const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
              if (activeEl) {
                activeEl.classList.remove('code-annotation-active');
              }
              selectCodeLines(clickedEl);
              clickedEl.classList.add('code-annotation-active');
            } else {
              // Unselect the line
              unselectCodeLines();
              clickedEl.classList.remove('code-annotation-active');
            }
          });
        }
    const findCites = (el) => {
      const parentEl = el.parentElement;
      if (parentEl) {
        const cites = parentEl.dataset.cites;
        if (cites) {
          return {
            el,
            cites: cites.split(' ')
          };
        } else {
          return findCites(el.parentElement)
        }
      } else {
        return undefined;
      }
    };
    var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
    for (var i=0; i<bibliorefs.length; i++) {
      const ref = bibliorefs[i];
      const citeInfo = findCites(ref);
      if (citeInfo) {
        tippyHover(citeInfo.el, function() {
          var popup = window.document.createElement('div');
          citeInfo.cites.forEach(function(cite) {
            var citeDiv = window.document.createElement('div');
            citeDiv.classList.add('hanging-indent');
            citeDiv.classList.add('csl-entry');
            var biblioDiv = window.document.getElementById('ref-' + cite);
            if (biblioDiv) {
              citeDiv.innerHTML = biblioDiv.innerHTML;
            }
            popup.appendChild(citeDiv);
          });
          return popup.innerHTML;
        });
      }
    }
  });
  </script>
</div> <!-- /content -->

</body>

</html>
